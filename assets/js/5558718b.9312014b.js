"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[476],{3094:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>a,default:()=>u,frontMatter:()=>l,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"configuration/webpack","title":"Customizing the Webpack Configuration","description":"Even though the included webpack configuration will handle most cases, we also provide the ability","source":"@site/docs/configuration/webpack.md","sourceDirName":"configuration","slug":"/configuration/webpack-customization","permalink":"/chayns-toolkit/docs/configuration/webpack-customization","draft":false,"unlisted":false,"editUrl":"https://github.com/TobitSoftware/chayns-toolkit/edit/main/docs/docs/configuration/webpack.md","tags":[],"version":"current","frontMatter":{"title":"Customizing the Webpack Configuration","slug":"webpack-customization","sidebar_label":"Webpack Customization"},"sidebar":"docs","previous":{"title":"Output","permalink":"/chayns-toolkit/docs/configuration/output"},"next":{"title":"Contributing","permalink":"/chayns-toolkit/docs/contributing"}}');var t=i(4848),s=i(8453);const l={title:"Customizing the Webpack Configuration",slug:"webpack-customization",sidebar_label:"Webpack Customization"},a=void 0,r={},c=[{value:"Examples",id:"examples",level:2},{value:"DefinePlugin",id:"defineplugin",level:3},{value:"Adding react-compiler",id:"adding-react-compiler",level:3},{value:"Adding a Babel Plugin",id:"adding-a-babel-plugin",level:3},{value:"Polyfilling a Node Module",id:"polyfilling-a-node-module",level:3}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"Even though the included webpack configuration will handle most cases, we also provide the ability\nto modify it."}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Please note that the webpack configuration does not follow semantic versioning and can change with\nany release."}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Use the ",(0,t.jsx)(n.code,{children:"webpack"})," property of the configuration object to specify a function that receives the\ndefault webpack configuration along with some other information. This modifier function has to\nreturn the modified configuration."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",metastring:'{5} title="/toolkit.config.js"',children:"module.exports = {\n    webpack(config, options) {\n        // ... do some modifications...\n\n        return config\n    },\n    // ... other options ...\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"The modifier function receives two arguments. First is our default webpack configuration, second is\nan object with additional information and utilities, following this interface:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'interface Options {\n    /**\n     * The webpack module. To avoid version conflicts, you should not import\n     * webpack on your own if you want to use one of the built-in plugins.\n     * No longer available with version 3\n     */\n    webpack: webpack\n\n    /**\n     * A boolean that specifies wether the configuration is for development or\n     * production.\n     */\n    dev: boolean\n\n    /**\n     * Specifies if the current build is for client or server\n     */\n    target: "client" | "server"\n}\n'})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["If you find yourself modifying the webpack configuration often for a feature that you think\nbelongs in our default config, please\n",(0,t.jsx)(n.a,{href:"https://github.com/TobitSoftware/create-chayns-app/issues",children:"open an issue"})," to discuss it."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,t.jsx)(n.h3,{id:"defineplugin",children:"DefinePlugin"}),"\n",(0,t.jsx)(n.p,{children:"Instead of webpack.DefinePlugin you can simply define variables via assignment to\nconfig.source.define."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'module.exports = {\n    webpack(config, { dev }) {\n        config.source.define.__DEVELOPMENT__ = dev\n        config.source.define.__QA__ = process.env.BUILD_ENV === "qa"\n        config.source.define.__STAGING__ = process.env.BUILD_ENV === "staging"\n        config.source.define.__PRODUCTION__ = process.env.BUILD_ENV === "production"\n\n        return config\n    },\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"adding-react-compiler",children:"Adding react-compiler"}),"\n",(0,t.jsxs)(n.p,{children:["Add the required devDependencies:\n",(0,t.jsx)(n.code,{children:"npm i @rsbuild/plugin-babel babel-plugin-react-compiler eslint-plugin-react-compiler -D"})]}),"\n",(0,t.jsxs)(n.p,{children:["When using react version prior to 19 also add: ",(0,t.jsx)(n.code,{children:"npm i react-compiler-runtime -D"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const { pluginBabel } = require(\"@rsbuild/plugin-babel\")\n\nmodule.exports = {\n    webpack(config) {\n        config.plugins.push(\n            pluginBabel({\n                include: /\\.(?:jsx|tsx)$/,\n                babelLoaderOptions(opts) {\n                    opts.plugins?.unshift([\n                        \"babel-plugin-react-compiler\",\n                        {\n                            // specify target react version, can be omitted for versions prior to 19\n                            target: \"18\", // '17' || '18' || '19'\n                        },\n                    ])\n                },\n            })\n        )\n\n        return config\n    },\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u26a0\ufe0f Below examples only work for versions prior to 3"}),"\n",(0,t.jsx)(n.h3,{id:"adding-a-babel-plugin",children:"Adding a Babel Plugin"}),"\n",(0,t.jsxs)(n.p,{children:["This example shows how to add\n",(0,t.jsx)(n.a,{href:"https://babeljs.io/docs/en/babel-plugin-proposal-pipeline-operator",children:(0,t.jsx)(n.code,{children:"@babel/plugin-proposal-pipeline-operator"})}),"\nto ",(0,t.jsx)(n.code,{children:"babel-loader"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",metastring:'title="/toolkit.config.js"',children:'module.exports = {\n    webpack(config) {\n        const babelRule = config.module.rules.find(\n            (rule) => rule.use.loader && rule.use.loader.includes("babel-loader")\n        )\n\n        if (!babelRule) return config\n\n        const babelOptions = babelRule.use.options\n\n        const pipelinePlugin = ["@babel/plugin-proposal-pipeline-operator", { proposal: "smart" }]\n\n        if (Array.isArray(babelOptions.plugins)) {\n            babelOptions.plugins.push(pipelinePlugin)\n        } else {\n            babelOptions.plugins = [pipelinePlugin]\n        }\n\n        return config\n    },\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"polyfilling-a-node-module",children:"Polyfilling a Node Module"}),"\n",(0,t.jsxs)(n.p,{children:["This example shows how to polyfill the Node.js ",(0,t.jsx)(n.code,{children:"crypto"})," module using a\n",(0,t.jsx)(n.a,{href:"https://webpack.js.org/configuration/resolve/#resolvefallback",children:"resolve fallback"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",metastring:'title="/toolkit.config.js"',children:'module.exports = {\n    webpack(config) {\n        config.resolve.fallback.crypto = require.resolve("crypto-browserify")\n\n        return config\n    },\n}\n'})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>a});var o=i(6540);const t={},s=o.createContext(t);function l(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);