"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[476],{5680:(e,n,o)=>{o.d(n,{xA:()=>s,yg:()=>f});var t=o(6540);function i(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function r(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),o.push.apply(o,t)}return o}function a(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?r(Object(o),!0).forEach((function(n){i(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}function l(e,n){if(null==e)return{};var o,t,i=function(e,n){if(null==e)return{};var o,t,i={},r=Object.keys(e);for(t=0;t<r.length;t++)o=r[t],n.indexOf(o)>=0||(i[o]=e[o]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)o=r[t],n.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}var c=t.createContext({}),p=function(e){var n=t.useContext(c),o=n;return e&&(o="function"==typeof e?e(n):a(a({},n),e)),o},s=function(e){var n=p(e.components);return t.createElement(c.Provider,{value:n},e.children)},u="mdxType",g={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},d=t.forwardRef((function(e,n){var o=e.components,i=e.mdxType,r=e.originalType,c=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),u=p(o),d=i,f=u["".concat(c,".").concat(d)]||u[d]||g[d]||r;return o?t.createElement(f,a(a({ref:n},s),{},{components:o})):t.createElement(f,a({ref:n},s))}));function f(e,n){var o=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=o.length,a=new Array(r);a[0]=d;var l={};for(var c in n)hasOwnProperty.call(n,c)&&(l[c]=n[c]);l.originalType=e,l[u]="string"==typeof e?e:i,a[1]=l;for(var p=2;p<r;p++)a[p]=o[p];return t.createElement.apply(null,a)}return t.createElement.apply(null,o)}d.displayName="MDXCreateElement"},7523:(e,n,o)=>{o.r(n),o.d(n,{contentTitle:()=>a,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var t=o(8168),i=(o(6540),o(5680));const r={title:"Customizing the Webpack Configuration",slug:"webpack-customization",sidebar_label:"Webpack Customization"},a=void 0,l={unversionedId:"configuration/webpack",id:"configuration/webpack",isDocsHomePage:!1,title:"Customizing the Webpack Configuration",description:"Even though the included webpack configuration will handle most cases, we also provide the ability",source:"@site/docs/configuration/webpack.md",sourceDirName:"configuration",slug:"/configuration/webpack-customization",permalink:"/chayns-toolkit/docs/configuration/webpack-customization",editUrl:"https://github.com/TobitSoftware/chayns-toolkit/edit/main/docs/docs/configuration/webpack.md",version:"current",frontMatter:{title:"Customizing the Webpack Configuration",slug:"webpack-customization",sidebar_label:"Webpack Customization"},sidebar:"docs",previous:{title:"Output",permalink:"/chayns-toolkit/docs/configuration/output"},next:{title:"Contributing",permalink:"/chayns-toolkit/docs/contributing"}},c=[{value:"Examples",id:"examples",children:[{value:"DefinePlugin",id:"defineplugin",children:[]},{value:"Adding react-compiler",id:"adding-react-compiler",children:[]},{value:"Adding a Babel Plugin",id:"adding-a-babel-plugin",children:[]},{value:"Polyfilling a Node Module",id:"polyfilling-a-node-module",children:[]}]}],p={toc:c},s="wrapper";function u(e){let{components:n,...o}=e;return(0,i.yg)(s,(0,t.A)({},p,o,{components:n,mdxType:"MDXLayout"}),(0,i.yg)("p",null,"Even though the included webpack configuration will handle most cases, we also provide the ability\nto modify it."),(0,i.yg)("blockquote",null,(0,i.yg)("p",{parentName:"blockquote"},"Please note that the webpack configuration does not follow semantic versioning and can change with\nany release.")),(0,i.yg)("p",null,"Use the ",(0,i.yg)("inlineCode",{parentName:"p"},"webpack")," property of the configuration object to specify a function that receives the\ndefault webpack configuration along with some other information. This modifier function has to\nreturn the modified configuration."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js",metastring:'{5} title="/toolkit.config.js"',"{5}":!0,title:'"/toolkit.config.js"'},"module.exports = {\n    webpack(config, options) {\n        // ... do some modifications...\n\n        return config\n    },\n    // ... other options ...\n}\n")),(0,i.yg)("p",null,"The modifier function receives two arguments. First is our default webpack configuration, second is\nan object with additional information and utilities, following this interface:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-ts"},'interface Options {\n    /**\n     * The webpack module. To avoid version conflicts, you should not import\n     * webpack on your own if you want to use one of the built-in plugins.\n     * No longer available with version 3\n     */\n    webpack: webpack\n\n    /**\n     * A boolean that specifies wether the configuration is for development or\n     * production.\n     */\n    dev: boolean\n\n    /**\n     * Specifies if the current build is for client or server\n     */\n    target: "client" | "server"\n}\n')),(0,i.yg)("blockquote",null,(0,i.yg)("p",{parentName:"blockquote"},"If you find yourself modifying the webpack configuration often for a feature that you think\nbelongs in our default config, please\n",(0,i.yg)("a",{parentName:"p",href:"https://github.com/TobitSoftware/create-chayns-app/issues"},"open an issue")," to discuss it.")),(0,i.yg)("h2",{id:"examples"},"Examples"),(0,i.yg)("h3",{id:"defineplugin"},"DefinePlugin"),(0,i.yg)("p",null,"Instead of webpack.DefinePlugin you can simply define variables via assignment to\nconfig.source.define."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},'module.exports = {\n    webpack(config, { dev }) {\n        config.source.define.__DEVELOPMENT__ = dev\n        config.source.define.__QA__ = process.env.BUILD_ENV === "qa"\n        config.source.define.__STAGING__ = process.env.BUILD_ENV === "staging"\n        config.source.define.__PRODUCTION__ = process.env.BUILD_ENV === "production"\n\n        return config\n    },\n}\n')),(0,i.yg)("h3",{id:"adding-react-compiler"},"Adding react-compiler"),(0,i.yg)("p",null,"Add the required devDependencies:\n",(0,i.yg)("inlineCode",{parentName:"p"},"npm i react-compiler @rsbuild/plugin-babel babel-plugin-react-compiler -D")),(0,i.yg)("p",null,"When using react version prior to 19 also add: ",(0,i.yg)("inlineCode",{parentName:"p"},"npm i react-compiler-runtime -D")),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"const { pluginBabel } = require(\"@rsbuild/plugin-babel\")\n\nmodule.exports = {\n    webpack(config) {\n        config.plugins.push(\n            pluginBabel({\n                include: /\\.(?:jsx|tsx)$/,\n                babelLoaderOptions(opts) {\n                    opts.plugins?.unshift([\n                        \"babel-plugin-react-compiler\",\n                        {\n                            // specify target react version\n                            target: \"18\", // '17' || '18' || '19'\n                        },\n                    ])\n                },\n            })\n        )\n\n        return config\n    },\n}\n")),(0,i.yg)("p",null,"\u26a0\ufe0f Below examples only work for versions prior to 3"),(0,i.yg)("h3",{id:"adding-a-babel-plugin"},"Adding a Babel Plugin"),(0,i.yg)("p",null,"This example shows how to add\n",(0,i.yg)("a",{parentName:"p",href:"https://babeljs.io/docs/en/babel-plugin-proposal-pipeline-operator"},(0,i.yg)("inlineCode",{parentName:"a"},"@babel/plugin-proposal-pipeline-operator")),"\nto ",(0,i.yg)("inlineCode",{parentName:"p"},"babel-loader"),":"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js",metastring:'title="/toolkit.config.js"',title:'"/toolkit.config.js"'},'module.exports = {\n    webpack(config) {\n        const babelRule = config.module.rules.find(\n            (rule) => rule.use.loader && rule.use.loader.includes("babel-loader")\n        )\n\n        if (!babelRule) return config\n\n        const babelOptions = babelRule.use.options\n\n        const pipelinePlugin = ["@babel/plugin-proposal-pipeline-operator", { proposal: "smart" }]\n\n        if (Array.isArray(babelOptions.plugins)) {\n            babelOptions.plugins.push(pipelinePlugin)\n        } else {\n            babelOptions.plugins = [pipelinePlugin]\n        }\n\n        return config\n    },\n}\n')),(0,i.yg)("h3",{id:"polyfilling-a-node-module"},"Polyfilling a Node Module"),(0,i.yg)("p",null,"This example shows how to polyfill the Node.js ",(0,i.yg)("inlineCode",{parentName:"p"},"crypto")," module using a\n",(0,i.yg)("a",{parentName:"p",href:"https://webpack.js.org/configuration/resolve/#resolvefallback"},"resolve fallback"),":"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js",metastring:'title="/toolkit.config.js"',title:'"/toolkit.config.js"'},'module.exports = {\n    webpack(config) {\n        config.resolve.fallback.crypto = require.resolve("crypto-browserify")\n\n        return config\n    },\n}\n')))}u.isMDXComponent=!0}}]);